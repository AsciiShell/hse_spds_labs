%!TEX TS-program = xelatex

% Шаблон документа LaTeX создан в 2018 году
% Алексеем Подчезерцевым
% В качестве исходных использованы шаблоны
% 	Данилом Фёдоровых (danil@fedorovykh.ru) 
%		https://www.writelatex.com/coursera/latex/5.2.2
%	LaTeX-шаблон для русской кандидатской диссертации и её автореферата.
%		https://github.com/AndreyAkinshin/Russian-Phd-LaTeX-Dissertation-Template

\documentclass[a4paper,14pt]{article}

\input{data/preambular.tex}
\begin{document} % конец преамбулы, начало документа
	\input{data/title.tex}
	\tableofcontents
	\pagebreak
	\section{Задание}
	
	\begin{enumerate}
		\item В соответствии с мануалом \_SPDS\_Lab\_2\_GPIO.pdf добавить на плату расширение в виде 7-ми сегментного индикатора (обязательно), DIP переключателя (обязательно) и светодиодов (если требуется).
		
		\item Изменить настройки проекта и вывести на новую дополнительную периферию информация о результатах работы процессора, провести тестирование работы программ, разработанных в работе 1.
		
		\item Создать  копию проекта и добавить в процессор дополнительный неархитектурный 8ми битный вход (к этому входу в файле верхнего уровня иерархии подключить DIP переключатель). Добавить в систему команд процессора ноовые команды, которые будут загружать данные с нового входа в заданный регистр и выставлять результат на другом выходе. В соответствии с вариантом (ваш вариант \% 5 + 1):
		
		Реализовать дополнение байта до 32-х бит "0"-ми.
		
		Переработать программы 01\_fibonacci/ и 02\_sqrt/, чтобы загружать значения из вне и выводить результат на внешнюю периферию платы. Провести моделирование и тестирование работоспособности проекта на прототипе.
		
		\item Скачать новую версию процессора и выполнить на вашей плате программы из предыдущих лабораторных работ. Убедиться, что они работают как в предыдущей работе. Выполнить программы: 04\_irq\_timer и 05\_exc\_ri. Добавить подробные комментарии к программам. Объяснить, чем эта версия schoolMIPS отличается от базовой.
	\end{enumerate}

	%{\small \VerbatimInput{../03_syn_pow_5_single_cycle_always/pow_5_single_cycle_always.v}}
	
	\section{Выполнение работы}
	
	%{\small \VerbatimInput{../program/00_counter/main.S}}
	
	\subsection{Изменение архитектуры процессора}
	
	Для поддержки процессором дополнительной переферии были внесены следующие изменения:
	
	\begin{itemize}
		
		\item Добавлен модуль $sm\_hex\_display\_digit$

		\item Добавлен модуль $sm\_hex\_display\_our$
		
		\item Изменен модуль верхнего уровня $de0\_cv$	
			
	\end{itemize}
		
		Модуль $sm\_hex\_display\_digit$ поочередно через 11 пинов GPIO оторажает результат на тройном 8-ми сегментном индикаторе.
		Листинг представлен ниже: 
		
		{\small \VerbatimInput{../src/sm_hex_display_digit.v}}
		
		Модуль $sm\_hex\_display\_our$ декодирует символ в его представление для отображения на 8-ми сегментном индикаторе.
		Листинг представлен ниже:
		
		{\small \VerbatimInput{logs/sm_hex_display_our.v}}
		
		В модуле верхнего уровня $de0\_cv$ часть пинов из GPIO\_0 связывается с gpioInput, GPIO\_1 связывается с gpioOutput.
			
		{\small \VerbatimInput{logs/changes_de0_cv.txt}}
	
	\subsection{Написание программ}
	
		GPIO input и GPIO output настроены таким образом, что для загрузки и выгрузки значений не нужны дополнительные инструкции.
		Для этих задач подходят уже имеющиеся в нашем процессоре инструкции $lw$ и $sw$.
		
	\subsubsection{последовательность Фибоначчи}
		
		Код программы вычисления последовательности Фибоначчи:
		
		{\small \VerbatimInput{../program/91_fibo/main.S}}
		
		Вейвформы:
		
		\begin{figure}[H]
			\centering
			\includegraphics[width=0.7\linewidth]{images/fibo_wvf}
			\caption{Выйвформа моделирования вычисления последовательность Фибоначчи}
			\label{fig:fibowvf}
		\end{figure}
		
	\subsubsection{Вычисление квадратного корня}
	
		Код программы вычисления квадратного корня:
	
		{\small \VerbatimInput{../program/92_sqrt/main.S}}
	
		Вейвформы:
		
		\begin{figure}[H]
			\centering
			\includegraphics[width=0.7\linewidth]{images/sqrt_wvf}
			\caption{Выйвформа моделирования вычисления квадратного корня}
			\label{fig:sqrtwvf}
		\end{figure}

		
	\section{Выводы по работе}
	
	В ходе работы получен опыт в написании кода на ассемблере MIPS.
	Был получен опыт чтения машинного кода.
	Был смоделирован процессор MIPS со входами GPIO.
	Был получен опыт работы с дополнительной переферией через GPIO.
	Были переделаны программы для демонстрции возможностей работы с GPIO.
	Было произведено моделирование в программе Icarus Verilog.
	Итоговый проект был собран и загружен на плату.
	
	\newpage 
	\renewcommand{\refname}{{\normalsize Список использованных источников}} 
	\centering 
	\begin{thebibliography}{9} 
		\addcontentsline{toc}{section}{\refname} 
		\bibitem{Harris} Хэррис Д. М., Хэррис С. Л. Цифровая схемотехника и архитектура компьютера. – 2015.
	\end{thebibliography}
	
\end{document} % конец документа
